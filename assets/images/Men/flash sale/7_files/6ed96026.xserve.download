"use strict";!function(){function a(a,b){a&&"number"==typeof a.id&&e.console&&e.console.log&&e.console.log(a.cmd+" Error: "+b)}function b(a,b){a&&"number"==typeof a.id&&e.parent.postMessage(JSON.stringify(a),b)}function c(){return"1"===h.getItem("disabled.xauth.org")}function d(a){var d=a.origin.split("://")[1].split(":")[0],e=JSON.parse(a.data);e&&"object"==typeof e&&e.cmd&&void 0!==e.id&&!c()&&k[e.cmd]&&b(k[e.cmd](d,e),a.origin)}var e=window,f=function(){var a=navigator.userAgent.toLowerCase();if(-1!==a.indexOf("safari")&&-1===a.indexOf("chrome"))return!1;try{e.localStorage.setItem("test","1"),e.localStorage.removeItem("test")}catch(b){return!1}return!0};if(!f()){var g=function(a){function b(a,b,c){var d,e;c?(d=new Date,d.setTime(d.getTime()+24*c*60*60*1e3),e="; expires="+d.toGMTString()):e="",document.cookie=a+"="+b+e+"; path=/"}function c(a){var b,c,d=a+"=",e=document.cookie.split(";");for(b=0;b<e.length;b++){for(c=e[b];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(d))return c.substring(d.length,c.length)}return null}function d(c){c=JSON.stringify(c),"session"===a?e.name=c:b("localStorage",c,3)}function f(){"session"===a?e.name="":b("localStorage","",3)}function g(){var b="session"===a?e.name:c("localStorage");return b?JSON.parse(b):{}}function h(){var a=0;for(var b in i)i.hasOwnProperty(b)&&(a+=1);return a}var i=g();return{clear:function(){i={},f(),this.length=h()},getItem:function(a){return a=encodeURIComponent(a),void 0===i[a]?null:i[a]},key:function(a){var b=0;for(var c in i){if(b===a)return decodeURIComponent(c);b++}return null},removeItem:function(a){a=encodeURIComponent(a),delete i[a],d(i),this.length=h()},setItem:function(a,b){a=encodeURIComponent(a),i[a]=String(b),d(i),this.length=h()},length:0}};e.fakeLocalStorage=new g("local")}if(e.top!==e&&e.postMessage&&e.localStorage&&e.JSON){var h=e.fakeLocalStorage||e.localStorage,i=null,j=document.cookie.match(/(?:^|;)\s*session=(\d+)(?:;|$)/);j&&j.length&&(i=j[1]),i||(i=(new Date).getTime(),document.cookie="session="+i+"; ");var k={"xauth::extend":function(b,c){if(!c.token)return a(c,"Invalid",b),null;c.token=String(c.token).substr(0,51024),c.expire=Number(c.expire);var d=new Date(c.expire);if(d<new Date)return a(c,"Invalid Expiration",b),null;if(!c.extend||!c.extend.length)return a(c,"No Extend List Specified",b),null;var e={token:c.token,expire:c.expire,extend:c.extend};return c.session===!0&&(e.session=i),h.setItem(c.tokenName,JSON.stringify(e)),{cmd:c.cmd,id:c.id}},"xauth::retrieve":function(b,c){if(!c.retrieve||!c.retrieve.length)return a(c,"No Retrieve List Requested",b),null;for(var d={},e=0;e<c.retrieve.length;e++){var f=c.retrieve[e],g=h.getItem(c.tokenName),j=g?JSON.parse(g):null;if(j&&!j.block){var k=b===f;if(!k)for(var l=0;l<j.extend.length;l++)if("*"===j.extend[l]||j.extend[l]===b){k=!0;break}if(k){var m=new Date(j.expire);if(m<new Date){h.removeItem(c.tokenName);continue}if(j.session&&j.session!==i){h.removeItem(c.tokenName);continue}d={token:j.token,expire:j.expire}}}}return{cmd:c.cmd,id:c.id,data:d}},"xauth::expire":function(a,b){return h.removeItem(b.tokenName),{cmd:b.cmd,id:b.id}}};e.addEventListener?e.addEventListener("message",d,!1):e.attachEvent&&e.attachEvent("onmessage",d),e.parent.postMessage(JSON.stringify({cmd:"xauth::ready"}),"*")}}();